{"version":3,"file":"swipegraph.min.js","sources":["../src/RefObject.js","../src/utils.js","../src/ProgressBar.js","../src/TranscodingBar.js","../src/genImageData.js","../src/toBlob.js","../src/setViewer.js","../src/polyfill-find.js","../src/index.js"],"sourcesContent":["function sendMessage(refObject, type, value) {\n  if (refObject.$iframe && refObject.$iframe.contentWindow) {\n    refObject.$iframe.contentWindow.postMessage({\n      type,\n      value,\n    }, '*');\n  } else refObject.dispatch(`$${type}`, value);\n}\n\nexport default class {\n  constructor(elem) {\n    this.elem = elem;\n    this.readyState = 'waiting';\n    this.$iframe = null;\n    this.$isInit = false;\n    this.$info = null;\n    this.$eventList = {};\n  }\n\n  $setInfo(info, originalInfo) {\n    this.$info = info;\n    this.readyState = 'loadedinfo';\n    this.dispatch('loadedinfo', originalInfo);\n    if (info.autoplay) this.$init();\n  }\n\n  $setMounted() {\n    this.readyState = 'mounted';\n    this.dispatch('mounted', null);\n  }\n\n  $setIframe(iframe) {\n    if (this.readyState !== 'mounted') this.$setMounted(); // autoplay or play before lazyloaded\n    this.$iframe = iframe;\n    this.readyState = 'loading';\n    this.dispatch('loadstart', null);\n  }\n\n  $iframeDidMount() {\n    this.readyState = 'loaded';\n    this.dispatch('loaded', null);\n    this.requestFullscreen();\n  }\n\n  $init() {\n    this.$isInit = true;\n  }\n\n  addSrcIndex(value) {\n    sendMessage(this, 'addSrcIndex', value);\n    return this;\n  }\n\n  setSrcIndex(value) {\n    sendMessage(this, 'setSrcIndex', value);\n    return this;\n  }\n\n  setFilter(value) {\n    sendMessage(this, 'setFilter', value);\n    return this;\n  }\n\n  setPosterIndex(value) {\n    sendMessage(this, 'setPosterIndex', value);\n    return this;\n  }\n\n  detach() {\n    if (this.$iframe) {\n      this.$iframe.contentWindow.postMessage({ type: 'detach' }, '*');\n    }\n    this.dispatch('$detach');\n  }\n\n  on(type, callback) {\n    this.$eventList[type] = this.$eventList[type] || [];\n    this.$eventList[type].push(callback);\n    return this;\n  }\n\n  off(type, callback) {\n    if (this.$eventList[type]) {\n      const index = this.$eventList[type].indexOf(callback);\n      if (index !== -1) this.$eventList[type].splice(index, 1);\n    }\n\n    return this;\n  }\n\n  one(type, callback) {\n    const fn = (e) => {\n      callback.call(this, e);\n      this.off(type, fn);\n    };\n    this.on(type, fn);\n    return this;\n  }\n\n  getInfo(callback) {\n    if (this.readyState === 'waiting') this.one('loadedinfo', (e) => { callback.call(this, e.value); });\n    else callback.call(this, this.$info);\n    return this;\n  }\n\n  dispatch(type, value) {\n    if (this.$eventList[type]) {\n      this.$eventList[type].forEach((callback) => {\n        callback.call(this, { type, value, target: this });\n      });\n    }\n\n    return this;\n  }\n}\n","const initedClassName = 'swipegraph-isinit';\n\nfunction getVisiblePlayer(list) {\n  const result = [];\n\n  list.forEach((refObject) => {\n    if (!refObject.$info || !refObject.$info.autoswipe) return;\n    const bounding = refObject.elem.getBoundingClientRect();\n    const wh = window.innerHeight;\n\n    if (bounding.top < wh && bounding.top > -bounding.height) result.push(refObject);\n  });\n\n  return result;\n}\n\nexport default {\n  initedClassName,\n  formatValue(elem, val) {\n    const tmpVal = Object.assign(\n      ['cid', 'src', 'ref', 'filter']\n        .reduce((prev, key) => (Object.assign({}, prev, { [key]: elem.getAttribute(`data-${key}`) })), {}),\n      ['fps', 'quality', 'head', 'lazyload', 'swipingwidth', 'autoswipe']\n        .reduce((prev, key) => (Object.assign({}, prev, { [key]: JSON.parse(elem.getAttribute(`data-${key}`)) })), {}),\n      val,\n    );\n\n    const param = {};\n    Object.keys(tmpVal).forEach((key) => {\n      const value = tmpVal[key];\n      if (value === null) return;\n\n      switch (key) {\n        case 'src': {\n          const fileNameLike = value.match(/\\/([^/]+?\\.[^/]+?)($|\\?)/);\n          if (fileNameLike === null) param.src = /\\/$/.test(value) ? value.slice(0, -1) : value;\n          else param.src = value.slice(0, fileNameLike.index);\n          param.iframeSrc = value;\n          break;\n        }\n        case 'cid':\n          param.contentId = value;\n          break;\n        case 'head':\n          param.headIndex = value;\n          break;\n        case 'swipingwidth':\n          param.swipingWidth = value;\n          break;\n        default:\n          param[key] = value;\n          break;\n      }\n    });\n\n    return param;\n  },\n  genInfo(param) {\n    const queryString = param.$auth ? `?${param.$auth}` : '';\n    return Object.assign(\n      {\n        queryString,\n        cdnQueryString: param.$cdnAuth ? `?${param.$cdnAuth}` : queryString,\n        contentId: '',\n        headIndex: 0,\n        quality: 0.5,\n        loop: false,\n        muted: false,\n        controls: true,\n        autoplay: false,\n        showingTitle: true,\n        swipingWidth: 20,\n        filter: '',\n        iconcolor: '#E60014',\n        iconhover: false,\n        allowfullscreen: true,\n        autoswipe: true,\n      },\n      param,\n    );\n  },\n  initAutoSwipe(refList) {\n    let prevScrollY = 0;\n\n    window.addEventListener('scroll', () => {\n      const scrollY = window.scrollY;\n      if (Math.abs(scrollY - prevScrollY) < 20) return;\n\n      const value = scrollY - prevScrollY < 0 ? -1 : 1;\n\n      getVisiblePlayer(refList).forEach((refObject) => {\n        refObject.addSrcIndex(value);\n      });\n\n      prevScrollY = scrollY;\n    }, false);\n  },\n  addStyle(elem, style) {\n    Object.keys(style).forEach(function(name) {\n      elem.style[name] = style[name];\n    });\n  },\n};\n","import utils from './utils';\n\nconst { addStyle } = utils;\n\nexport default class {\n  constructor() {\n    this.loaded = 0;\n    this.total = 1;\n    const container = document.createElement('div');\n    addStyle(container, {\n      position: 'absolute',\n      top: '50%',\n      left: '50%',\n      transform: 'translate(-50%,70px)',\n    });\n\n    const text = document.createElement('div');\n    addStyle(text, {\n      textAlign: 'center',\n      color: '#555',\n      fontSize: '12px',\n    });\n    text.innerText = '/';\n    container.appendChild(text);\n\n    const barFrame = document.createElement('div');\n    addStyle(barFrame, {\n      width: '200px',\n      height: '5px',\n      background: '#ccc',\n      marginTop: '5px',\n      position: 'relative',\n    });\n    container.appendChild(barFrame);\n\n    const bar = document.createElement('div');\n    addStyle(bar, {\n      width: '0px',\n      height: '100%',\n      background: '#5699d2',\n      position: 'absolute',\n      top: 0,\n      left: 0,\n    });\n    barFrame.appendChild(bar);\n\n    this.container = container;\n    this.textElem = text;\n    this.barElem = bar;\n  }\n\n  update(loaded, total) {\n    this.textElem.innerText = `${Math.floor(loaded / 102.4 / 1024) / 10} / ${Math.floor(total / 102.4 / 1024) / 10}MB`;\n    this.barElem.style.width = `${loaded / total * 100}%`;\n  }\n}\n","import utils from './utils';\n\nconst { addStyle } = utils;\n\nexport default class {\n  constructor() {\n    this.loaded = 0;\n    this.total = 1;\n    const container = document.createElement('div');\n    addStyle(container, {\n      position: 'absolute',\n      bottom: 0,\n      left: 0,\n      right: 0,\n    });\n\n    const bar = document.createElement('div');\n    addStyle(bar, {\n      width: '0%',\n      height: '5px',\n      background: '#f00',\n    });\n    container.appendChild(bar);\n\n    this.container = container;\n    this.barElem = bar;\n  }\n\n  update(loaded, total) {\n    this.barElem.style.width = `${loaded / total * 100}%`;\n  }\n}\n","import utils from './utils';\nimport TranscodingBar from './TranscodingBar';\nimport toBlob from './toBlob';\nconst { addStyle } = utils;\n\nexport default (videoData, imageDataList, info, root, onSetViewer) => {\n  const videoSrc = URL.createObjectURL(videoData);\n  const transcodingBar = new TranscodingBar();\n\n  let tmpList = [];\n  let totalCount = 0;\n  let completed = 0;\n\n  const createImg = (n, video, ctx, canvas) => {\n    video.ontimeupdate = () => {\n      video.ontimeupdate = null;\n      ctx.drawImage(video, 0, 0);\n\n      toBlob(canvas, (blob) => {\n        tmpList[n] = URL.createObjectURL(blob);\n        imageDataList.length = 0;\n        Array.prototype.push.apply(imageDataList, tmpList.filter(data => !!data));\n        if (imageDataList.length === totalCount) {\n          tmpList = null;\n          root.removeChild(transcodingBar.container);\n          URL.revokeObjectURL(videoSrc);\n        } else {\n          transcodingBar.update(imageDataList.length, totalCount);\n        }\n      }, 'image/jpeg', info.quality);\n\n      if (n < totalCount - 1) createImg(n + 1, video, ctx, canvas);\n    };\n\n    video.currentTime = n / info.fps;\n  }\n\n  const video = document.createElement('video');\n  totalCount = Math.floor(video.duration * info.fps);\n  video.playsinline = 1;\n  video.oncanplaythrough = (e) => {\n    const video = e.target;\n    onSetViewer(video.videoWidth, video.videoHeight);\n    root.appendChild(transcodingBar.container);\n    video.oncanplaythrough = null;\n    totalCount = Math.floor(video.duration * info.fps);\n    const canvas = document.createElement('canvas');\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    createImg(0, video, canvas.getContext('2d'), canvas);\n  };\n  video.src = videoSrc;\n  video.load();\n}\n","export default (canvas, callback, type, quality) => {\n  if (canvas.toBlob) {\n    canvas.toBlob(callback, type, quality);\n  } else {\n    const binStr = atob(canvas.toDataURL(type, quality).split(',')[1]);\n    const len = binStr.length;\n    const arr = new Uint8Array(len);\n\n    for (let i = 0; i < len; i++) {\n      arr[i] = binStr.charCodeAt(i);\n    }\n\n    callback(new Blob([arr], { type }));\n  }\n}\n","import utils from './utils';\nconst { addStyle } = utils;\n\nexport default (imageDataList, root, info, videoWidth, videoHeight) => {\n  let initSwiped = false;\n  let swiping = false;\n  let prevX = null;\n  let prevY = null;\n  let srcIndex = 0;\n\n  root.innerHTML = '';\n  root.style.paddingTop = videoHeight / videoWidth * 100 + '%';\n\n  const image = new Image();\n  addStyle(image, {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    backfaceVisibility: 'hidden',\n  });\n  root.appendChild(image);\n\n  const touchElem = document.createElement('div');\n  addStyle(touchElem, {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    zIndex: 1000000,\n    top: 0,\n    left: 0,\n  });\n  root.appendChild(touchElem);\n\n  const swipeStart = (e) => {\n    e.preventDefault();\n    initSwiped = true;\n    swiping = true;\n    touchElem.style.position = 'fixed';\n  };\n\n  const swipeEnd = () => {\n    swiping = false;\n    touchElem.style.position = 'absolute';\n  };\n\n  touchElem.addEventListener('mousedown', swipeStart, false);\n  touchElem.addEventListener('touchstart', swipeStart, false);\n\n  touchElem.addEventListener('mouseup', swipeEnd, false);\n  touchElem.addEventListener('touchend', swipeEnd, false);\n\n  const addSrcIndex = (value) => {\n    if (imageDataList.length === 0) return;\n    let swipedIndex = (srcIndex + value) % imageDataList.length;\n    if (swipedIndex < 0) {\n      swipedIndex += imageDataList.length;\n    }\n    srcIndex = swipedIndex;\n  }\n\n  const update = () => {\n    const i = srcIndex === 0 ? 1 : srcIndex; // > 1 for iOS Safari\n    if (!imageDataList[i]) {\n      setTimeout(update, 16);\n      return;\n    }\n    image.src = imageDataList[i];\n  }\n\n  const handleSwipe = (e) => {\n    if (!swiping && (initSwiped || !info.autoswipe)) return;\n\n    const x = typeof e.clientX === 'number' ? e.clientX : e.touches[0].pageX;\n    const y = typeof e.clientY === 'number' ? e.clientY : e.touches[0].pageY;\n    \n    if (prevX === null) {\n      prevX = x;\n      prevY = y;\n    } else if (Math.abs(x - prevX) > Math.abs(y - prevY)) {\n      addSrcIndex(x - prevX > 0 ? -1 : 1);\n      const pX = prevX;\n      setTimeout(() => addSrcIndex(x - pX > 0 ? -1 : 1), 33);\n      update();\n      prevX = x;\n      prevY = y;\n    } else {\n      addSrcIndex(y - prevY > 0 ? -1 : 1);\n      const pY = prevY;\n      setTimeout(() => addSrcIndex(y - pY > 0 ? -1 : 1), 33);\n      update();\n      prevX = x;\n      prevY = y;\n    }\n  };\n\n  touchElem.addEventListener('mousemove', handleSwipe, false);\n  touchElem.addEventListener('touchmove', handleSwipe, false);\n\n  update();\n}","if (!Array.prototype.find) {\n  Array.prototype.find = function(predicate) {\n    if (this === null) {\n      throw new TypeError('Array.prototype.find called on null or undefined');\n    }\n    if (typeof predicate !== 'function') {\n      throw new TypeError('predicate must be a function');\n    }\n    var list = Object(this);\n    var length = list.length >>> 0;\n    var thisArg = arguments[1];\n    var value;\n\n    for (var i = 0; i < length; i++) {\n      value = list[i];\n      if (predicate.call(thisArg, value, i, list)) {\n        return value;\n      }\n    }\n    return undefined;\n  };\n}\n","import RefObject from './RefObject';\nimport utils from './utils';\nimport loadingSvg from './loading.svg';\nimport ProgressBar from './ProgressBar';\nimport genImageData from './genImageData';\nimport setViewer from './setViewer';\nimport './polyfill-find';\n\nconst { initedClassName, formatValue, genInfo, addStyle } = utils;\n\nconst VERSION = process.env.VERSION;\nconst refObjectCache = [];\nconst imageDataCache = [];\nutils.initAutoSwipe(refObjectCache);\n\nconst swipegraph = {\n  version: VERSION,\n  config: { autoEmbed: true },\n  refs: {},\n  attach: (elem, value) => {\n    if (new RegExp(initedClassName).test(elem.className)) {\n      return refObjectCache.find(ref => ref.elem === elem);\n    }\n\n    elem.classList.add(initedClassName);\n\n    const param = formatValue(elem, value);\n\n    const refObject = new RefObject(elem);\n    refObjectCache.push(refObject);\n\n    if (param.ref) swipegraph.refs[param.ref] = refObject;\n\n    const root = document.createElement('div');\n    addStyle(root, {\n      paddingTop: '56.25%',\n      position: 'relative',\n    });\n    root.innerHTML = loadingSvg;\n    elem.appendChild(root);\n\n    const progress = new ProgressBar();\n    root.appendChild(progress.container);\n\n    const info = genInfo(param);\n    refObject.$setInfo(info);\n\n    const videoPath = `${info.iframeSrc}/${info.contentId}/video.mp4`;\n    const cachedURL = imageDataCache.find(obj => obj.originPath === videoPath);\n\n    if (cachedURL) {\n      setViewer(cachedURL.data, root, info, cachedURL.width, cachedURL.height);\n    } else {\n      const cachedData = {\n        originPath: videoPath,\n        width: null,\n        height: null,\n        data: [],\n      };\n      imageDataCache.push(cachedData);\n\n      const xhr = new XMLHttpRequest();\n      xhr.open('GET', videoPath);\n      xhr.responseType = 'blob';\n      xhr.onload = (e) => {\n        genImageData(e.target.response, cachedData.data, info, root, (width, height) => {\n          cachedData.width = width;\n          cachedData.height = height;\n          setViewer(cachedData.data, root, info, width, height);\n        });\n      };\n\n      xhr.onprogress = (evt) => {\n        if (evt.lengthComputable) progress.update(evt.loaded, evt.total);\n      };\n      xhr.send();\n    }\n\n    refObject.on('$detach', ({ target }) => {\n      target.elem.classList.remove(initedClassName);\n      const index = refObjectCache.indexOf(target);\n      if (index !== -1) refObjectCache.splice(index, 1);\n      Object.keys(swipegraph.refs).forEach((ref) => {\n        if (swipegraph.refs[ref] === target) {\n          swipegraph.refs[ref] = null;\n          delete swipegraph.refs[ref];\n        }\n      });\n\n      target.elem.removeChild(root);\n    });\n\n    return refObject;\n  },\n  detach: (elem) => {\n    const refObject = refObjectCache.find(t => t.elem === elem);\n    if (refObject) refObject.detach();\n  },\n};\n\nif (typeof window === 'object') {\n  const embed = () => {\n    Array.prototype.forEach.call(document.querySelectorAll('.swipegraph'), (elem) => { swipegraph.attach(elem); });\n  };\n\n  // setTimeout for rewriting config\n  setTimeout(() => {\n    if (swipegraph.config.autoEmbed) {\n      if (document.readyState !== 'loading') embed();\n      else window.addEventListener('DOMContentLoaded', embed, false);\n    }\n  });\n\n  /* eslint-disable no-console */\n  console.log(`SwipeGraph v${VERSION}`);\n};\n\nexport default swipegraph;\n"],"names":["sendMessage","refObject","type","value","$iframe","contentWindow","postMessage","dispatch","elem","readyState","$isInit","$info","$eventList","info","originalInfo","autoplay","this","$init","iframe","$setMounted","requestFullscreen","callback","push","index","indexOf","splice","on","fn","e","call","off","one","forEach","target","val","tmpVal","Object","assign","reduce","prev","key","getAttribute","JSON","parse","param","keys","fileNameLike","match","src","test","slice","iframeSrc","contentId","headIndex","swipingWidth","queryString","$auth","$cdnAuth","refList","prevScrollY","addEventListener","scrollY","window","Math","abs","list","result","autoswipe","bounding","getBoundingClientRect","wh","innerHeight","top","height","addSrcIndex","style","name","loaded","total","container","document","createElement","text","innerText","appendChild","barFrame","bar","textElem","barElem","floor","width","addStyle","utils","videoData","imageDataList","root","onSetViewer","videoSrc","URL","createObjectURL","transcodingBar","TranscodingBar","tmpList","totalCount","createImg","n","video","ctx","canvas","ontimeupdate","drawImage","quality","toBlob","binStr","atob","toDataURL","split","len","length","arr","Uint8Array","i","charCodeAt","Blob","blob","prototype","apply","filter","data","removeChild","revokeObjectURL","update","currentTime","fps","duration","playsinline","oncanplaythrough","videoWidth","videoHeight","getContext","load","initSwiped","swiping","prevX","prevY","srcIndex","innerHTML","paddingTop","image","Image","touchElem","swipeStart","preventDefault","position","swipeEnd","swipedIndex","handleSwipe","x","clientX","touches","pageX","y","clientY","pageY","pX","pY","Array","find","predicate","TypeError","thisArg","arguments","initedClassName","formatValue","genInfo","refObjectCache","imageDataCache","swipegraph","autoEmbed","RegExp","className","ref","classList","add","RefObject","refs","progress","ProgressBar","$setInfo","videoPath","cachedURL","obj","originPath","cachedData","xhr","XMLHttpRequest","open","responseType","onload","response","onprogress","evt","lengthComputable","send","remove","t","detach","embed","querySelectorAll","attach","config","log"],"mappings":"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"}